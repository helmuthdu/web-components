class UiLoading extends HTMLElement {
  // Replace these with your actual SVG data URLs or inline SVG markup
  static SVGS = {
    cloud: `
<svg
   width="80"
   height="25.714287"
   viewBox="0 0 80 25.714287"
   version="1.1"
   id="svg1"
   xml:space="preserve"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg"><defs
     id="defs1" /><g
     id="layer1"
     transform="matrix(3.5995501,0,0,3.5995501,-197.16625,-620.46319)"><path
       fill="currentColor"
       d="m 57.430801,179.48607 -0.0042,-1.12609 0.560643,-0.0151 0.0071,0.64181 h 9.23837 9.23836 v -0.15119 l 0.0078,-0.16289 -0.516791,-0.002 5.25e-4,-0.77105 -0.663254,0.0291 h -0.41578 v -0.52917 -0.52916 h -0.79375 -0.79375 v -0.52917 -0.52917 h -1.32291 -1.32292 v -0.26458 -0.26458 h -0.43199 -0.43198 l -0.709176,0.022 -0.01435,-1.08032 h -0.26458 -0.26459 v -0.39687 -0.39688 h -0.52916 -0.52917 v -0.26458 -0.26458 h -0.52917 -0.52916 v 0.26458 0.26458 h -1.26451 -1.26451 l -0.3814,0.52917 -0.3814,0.52917 h -0.47076 -0.47076 v 0.79375 0.79375 h -0.73534 -0.73534 l -0.3814,0.52916 -0.3814,0.52917 h -1.68028 -1.68028 l -0.37798,0.37798 -0.37798,0.37797 v 0.54807 0.54806 h -0.52916 -0.52917 v -0.26458 -0.26458 h 0.26458 0.26459 v -0.54807 -0.54806 l 0.37797,-0.37798 0.37798,-0.37798 h 1.68028 1.68028 l 0.3814,-0.52916 0.38141,-0.52917 h 0.73534 0.73534 v -0.79375 -0.79375 h 0.47075 0.47076 l 0.3814,-0.52917 0.38141,-0.52916 h 1.2645 1.26451 v -0.26459 -0.26458 h 1.05833 1.05834 v 0.26458 0.26459 h 0.52916 0.52917 v 0.39687 0.39688 h 0.26458 0.26459 v 0.52916 0.52917 h 0.79375 0.79375 v 0.26458 0.26459 h 1.32291 1.32292 v 0.52916 0.52917 h 0.79375 0.79375 v 0.52917 0.52916 h 0.52917 0.52916 v 0.52917 0.31857 h 0.26459 0.26458 v 0.73976 0.52917 l -9.45885,-0.0101 -9.45886,-0.0101 z"
       id="path27" /></g></svg>`,
    dinoJump: `
<svg
   width="55.81395"
   height="60"
   viewBox="0 0 55.81395 60"
   version="1.1"
   id="svg1"
   xml:space="preserve"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg"><defs
     id="defs1" /><g
     id="layer1"
     transform="matrix(0.69767434,0,0,0.69767434,-181.27892,-563.63423)"><path
       d="m 279.83315,885.87583 v -7.99997 h -2 -2 v -2.00002 -2.00001 h -2 -2 v -1.99997 -2.00002 h -2 -2 v -2.00001 -1.99997 h -2 -2 v -2.00002 -2.00001 h -2 -2 v -12 -12 h 2 2 v 4.00003 3.99998 h 2 2 v 2.00002 1.99997 h 2 2 v 2.00001 2.00002 h 4 4 v -2.00002 -2.00001 h 2 2 v -1.99997 -2.00002 h 3 3 v -2.00001 -1.99997 h 3 3 v -2.00002 -2.00001 h 2 2 v -12.99999 -12.99998 h 2 2 v -2.00002 -2.00001 h 16 16 v 2.00001 2.00002 h 2 2 v 9 9 h -10 -10 v 1.99997 2.00001 h 6 6 v 2.00002 1.99997 h -8 -8 v 4.00003 3.99998 h 4 4 v 3.99999 4.00003 h -2 -2 v -2.00002 -2.00001 h -2 -2 v 7.00003 6.99998 h -2 -2 v 3 3 h -2 -2 v 2.00002 1.99997 h -2 -2 v 8.00001 8.00002 h 2 2 v 1.99997 2.00001 h -4 -4 v -6 -6 h -2 -2 v -2.00001 -1.99997 h -2 -2 v 1.99997 2.00001 h -2 -2 v 2.00002 1.99997 h -2 -2 v 2.00001 2.00002 h 2 2 v 1.99997 2.00001 h -4 -4 z m 32,-69.99999 v -2.00001 h -2 -2 v 2.00001 2.00002 h 2 2 z"
       fill="currentColor"
       id="path1"
       style="stroke-width:3.77953" /></g></svg>`,
    dinoRun1: `
<svg
   width="55.813911"
   height="60"
   viewBox="0 0 55.813911 60"
   version="1.1"
   id="svg1"
   xml:space="preserve"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg"><defs
     id="defs1" /><g
     id="layer1"
     transform="matrix(2.6368793,0,0,2.6368793,-240.14636,-563.63422)"><path
       d="m 96.363857,234.38798 v -2.11666 h -0.52917 -0.52917 v -0.52917 -0.52917 h -0.52916 -0.52917 v -0.52916 -0.52917 h -0.52917 -0.52916 v -0.52917 -0.52916 h -0.52917 -0.529166 v -0.52917 -0.52917 h -0.529167 -0.529167 v -3.175 -3.175 h 0.529167 0.529167 v 1.05834 1.05833 h 0.529166 0.52917 v 0.52917 0.52916 h 0.52916 0.52917 v 0.52917 0.52917 h 1.05833 1.05834 v -0.52917 -0.52917 h 0.52916 0.52917 v -0.52916 -0.52917 h 0.79375 0.79375 v -0.52917 -0.52916 h 0.79375 0.793753 v -0.52917 -0.52917 h 0.52917 0.52917 v -3.43958 -3.43958 h 0.52916 0.52917 v -0.52917 -0.52917 h 4.23332 4.23333 v 0.52917 0.52917 h 0.52917 0.52916 v 2.38125 2.38125 h -2.64583 -2.64583 v 0.52916 0.52917 h 1.5875 1.5875 v 0.52917 0.52916 h -2.11667 -2.11666 v 1.05834 1.05833 h 1.05833 1.05833 v 1.05833 1.05834 h -0.52916 -0.52917 v -0.52917 -0.52917 h -0.52917 -0.52916 v 1.85209 1.85208 h -0.52917 -0.52917 v 0.79375 0.79375 h -0.52916 -0.52917 v 0.52917 0.52916 h -0.52916 -0.52916 v 0.52917 0.52917 h 0.79374 0.79375 v 0.52916 0.52917 h -1.32292 -1.3229 v -0.52917 -0.52916 h -1.05834 -1.058333 v 0.52916 0.52917 h -0.52917 -0.52917 v 0.52917 0.52916 h -0.52916 -0.52917 v 0.52917 0.52917 h 0.52917 0.52916 v 0.52916 0.52917 h -1.05833 -1.05833 z m 8.466653,-18.52083 v -0.52917 h -0.52916 -0.52917 v 0.52917 0.52917 h 0.52917 0.52916 z"
       fill="currentColor"
       id="path1-7" /></g></svg>`,
    dinoRun2: `
<svg
   width="55.813934"
   height="60"
   viewBox="0 0 55.813934 60"
   version="1.1"
   id="svg1"
   xml:space="preserve"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg"><defs
     id="defs1" /><g
     id="layer1"
     transform="matrix(2.6368793,0,0,2.6368793,-299.01375,-563.63422)"><path
       d="m 123.98016,234.91715 v -1.5875 h -0.52917 -0.52917 v -0.52917 -0.52916 h -1.05833 -1.05833 v 0.52916 0.52917 h 0.52916 0.52917 v 0.52917 0.52916 h -1.05833 -1.05834 v -0.52916 -0.52917 h -0.52916 -0.52917 v -0.52917 -0.52916 h -0.52917 -0.52916 v -0.52917 -0.52917 h -0.52917 -0.52917 v -0.52916 -0.52917 h -0.52916 -0.52917 v -0.52917 -0.52916 h -0.52917 -0.52916 v -0.52917 -0.52917 h -0.52916 -0.52917 v -3.175 -3.175 h 0.52917 0.52916 v 1.05834 1.05833 h 0.52916 0.52917 v 0.52917 0.52916 h 0.52917 0.52916 v 0.52917 0.52917 h 1.05834 1.05833 v -0.52917 -0.52917 h 0.52917 0.52916 v -0.52916 -0.52917 h 0.79375 0.79375 v -0.52917 -0.52916 h 0.79375 0.79375 v -0.52917 -0.52917 h 0.52917 0.52917 v -3.43958 -3.43958 h 0.52916 0.52917 v -0.52917 -0.52917 h 4.23333 4.23334 v 0.52917 0.52917 h 0.52916 0.52917 v 2.38125 2.38125 h -2.64583 -2.64584 v 0.52916 0.52917 h 1.5875 1.5875 v 0.52917 0.52916 h -2.11666 -2.11667 v 1.05834 1.05833 h 1.05833 1.05834 v 1.05833 1.05834 h -0.52917 -0.52917 v -0.52917 -0.52917 h -0.52916 -0.52917 v 1.85209 1.85208 h -0.52917 -0.52916 v 0.79375 0.79375 h -0.52917 -0.52917 v 0.52917 0.52916 h -0.52916 -0.52917 v 2.11667 2.11667 h 0.52917 0.52916 v 0.52916 0.52917 h -1.05833 -1.05833 z m 3.175,-19.05 v -0.52917 h -0.52917 -0.52917 v 0.52917 0.52917 h 0.52917 0.52917 z"
       fill="currentColor"
       id="path1-5" /></g></svg>`,
    horizon: `
<svg
   width="2400"
   height="15.999987"
   viewBox="0 0 2400 15.999987"
   version="1.1"
   id="svg1"
   xml:space="preserve"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg"><defs
     id="defs1" /><g
     id="layer1"
     transform="matrix(3.7795305,0,0,3.7795305,463.30933,-742.0731)"><path
       fill="currentColor"
       d="m -122.58383,200.30877 v -0.26459 h 1.05833 1.05833 v 0.26459 0.26458 h -1.05833 -1.05833 z m 7.40833,0 v -0.26459 h 0.52917 0.52916 v 0.26459 0.26458 h -0.52916 -0.52917 z m 17.991673,0 v -0.26459 h 1.05833 1.05833 v 0.26459 0.26458 h -1.05833 -1.05833 z m 39.15833,0 v -0.26459 h 0.26458 0.26459 v 0.26459 0.26458 h -0.26459 -0.26458 z m 112.712497,0 v -0.26459 h 0.79375 0.79375 v 0.26459 0.26458 H 55.48075 54.687 Z m 42.8625,0 v -0.26459 h 1.058334 1.058333 v 0.26459 0.26458 H 98.607834 97.5495 Z m 6.35,0 v -0.26459 h 0.26458 0.26459 v 0.26459 0.26458 h -0.26459 -0.26458 z m 50.8,0 v -0.26459 h 0.52917 0.52916 v 0.26459 0.26458 h -0.52916 -0.52917 z m 33.86667,0 v -0.26459 h 0.26458 0.26458 v 0.26459 0.26458 h -0.26458 -0.26458 z m 6.34999,0 v -0.26459 h 1.05834 1.05833 v 0.26459 0.26458 h -1.05833 -1.05834 z m 7.40834,0 v -0.26459 h 0.52916 0.52917 v 0.26459 0.26458 h -0.52917 -0.52916 z m 17.99167,0 v -0.26459 h 1.05833 1.05833 v 0.26459 0.26458 h -1.05833 -1.05833 z m 39.15833,0 v -0.26459 h 0.26458 0.26459 v 0.26459 0.26458 h -0.26459 -0.26458 z m 112.7125,0 v -0.26459 h 0.79375 0.79375 v 0.26459 0.26458 h -0.79375 -0.79375 z m 42.8625,0 v -0.26459 h 1.05833 1.05834 v 0.26459 0.26458 h -1.05834 -1.05833 z m 6.35,0 v -0.26459 h 0.26458 0.26459 v 0.26459 0.26458 h -0.26459 -0.26458 z m 50.8,0 v -0.26459 h 0.52917 0.52916 v 0.26459 0.26458 h -0.52916 -0.52917 z m 33.86667,0 v -0.26459 h 0.26458 0.26458 v 0.26459 0.26458 h -0.26458 -0.26458 z M -100.888,199.7796 v -0.26458 h 0.26458 0.26459 v 0.26458 0.26458 h -0.26459 -0.26458 z m 15.345833,0 v -0.26458 h 0.52917 0.52917 v 0.26458 0.26458 h -0.52917 -0.52917 z m 10.58334,0 v -0.26458 h 1.05833 1.05833 v 0.26458 0.26458 h -1.05833 -1.05833 z m 24.87083,0 v -0.26458 h 0.52917 0.52916 v 0.26458 0.26458 h -0.52916 -0.52917 z m 21.69583,0 v -0.26458 h 0.26459 0.26458 v 0.26458 0.26458 h -0.26458 -0.26459 z m 5.29167,0 v -0.26458 h 0.79375 0.79375 v 0.26458 0.26458 h -0.79375 -0.79375 z m 39.158331,0 v -0.26458 H 16.322417 16.587 v 0.26458 0.26458 h -0.264583 -0.264583 z m 2.116666,0 v -0.26458 h 0.529167 0.529167 v 0.26458 0.26458 H 18.703667 18.1745 Z m 8.466667,0 v -0.26458 h 0.79375 0.79375 v 0.26458 0.26458 h -0.79375 -0.79375 z m 96.308333,0 v -0.26458 h 0.52917 0.52916 v 0.26458 0.26458 h -0.52916 -0.52917 z m 57.15,0 v -0.26458 h 0.26458 0.26459 v 0.26458 0.26458 h -0.26459 -0.26458 z m 36.5125,0 v -0.26458 h 0.26458 0.26459 v 0.26458 0.26458 h -0.26459 -0.26458 z m 15.34583,0 v -0.26458 h 0.52917 0.52917 v 0.26458 0.26458 h -0.52917 -0.52917 z m 10.58334,0 v -0.26458 h 1.05833 1.05833 v 0.26458 0.26458 h -1.05833 -1.05833 z m 24.87083,0 v -0.26458 h 0.52917 0.52916 v 0.26458 0.26458 h -0.52916 -0.52917 z m 21.69583,0 v -0.26458 h 0.26459 0.26458 v 0.26458 0.26458 h -0.26458 -0.26459 z m 5.29167,0 v -0.26458 h 0.79375 0.79375 v 0.26458 0.26458 h -0.79375 -0.79375 z m 39.15833,0 v -0.26458 h 0.26459 0.26458 v 0.26458 0.26458 h -0.26458 -0.26459 z m 2.11667,0 v -0.26458 h 0.52917 0.52916 v 0.26458 0.26458 h -0.52916 -0.52917 z m 8.46667,0 v -0.26458 h 0.79375 0.79375 v 0.26458 0.26458 h -0.79375 -0.79375 z m 96.30833,0 v -0.26458 h 0.52917 0.52916 v 0.26458 0.26458 h -0.52916 -0.52917 z m 57.15,0 v -0.26458 h 0.26458 0.26459 v 0.26458 0.26458 h -0.26459 -0.26458 z M -0.34632967,199.25043 v -0.26458 h 0.26458 0.26458 v 0.26458 0.26459 h -0.26458 -0.26458 z m 35.98332967,0 v -0.26458 h 0.264584 0.264583 v 0.26458 0.26459 H 35.901584 35.637 Z m 58.7375,0 v -0.26458 h 0.529167 0.529167 v 0.26458 0.26459 H 94.903667 94.3745 Z m 42.8625,0 v -0.26458 h 0.26458 0.26459 v 0.26458 0.26459 h -0.26459 -0.26458 z m 12.7,0 v -0.26458 h 0.79375 0.79375 v 0.26458 0.26459 h -0.79375 -0.79375 z m 167.21667,0 v -0.26458 h 0.26458 0.26458 v 0.26458 0.26459 h -0.26458 -0.26458 z m 35.98333,0 v -0.26458 h 0.26458 0.26459 v 0.26458 0.26459 h -0.26459 -0.26458 z m 58.7375,0 v -0.26458 h 0.52917 0.52916 v 0.26458 0.26459 h -0.52916 -0.52917 z m 42.8625,0 v -0.26458 h 0.26458 0.26459 v 0.26458 0.26459 h -0.26459 -0.26458 z m 12.7,0 v -0.26458 h 0.79375 0.79375 v 0.26458 0.26459 h -0.79375 -0.79375 z m -586.84583,-0.52916 v -0.26459 h 1.05833 1.05833 v 0.26459 0.26458 h -1.05833 -1.05833 z m 41.804163,0 v -0.26459 h 0.26459 0.26458 v 0.26459 0.26458 h -0.26458 -0.26459 z m 8.99584,0 v -0.26459 h 0.52916 0.52917 v 0.26459 0.26458 h -0.52917 -0.52916 z m 42.33333,0 v -0.26459 h 0.52917 0.52916 v 0.26459 0.26458 h -0.52916 -0.52917 z m 17.4624973,0 v -0.26459 h 0.26458 0.26459 v 0.26459 0.26458 h -0.26459 -0.26458 z m 16.40417,0 v -0.26459 h 0.26458 0.26458 v 0.26459 0.26458 h -0.26458 -0.26458 z m 39.6874967,0 v -0.26459 H 47.807834 48.337 v 0.26459 0.26458 h -0.529166 -0.529167 z m 21.695833,0 v -0.26459 h 0.264584 0.264583 v 0.26459 0.26458 H 69.239084 68.9745 Z m 10.054167,0 v -0.26459 h 0.79375 0.79375 v 0.26459 0.26458 h -0.79375 -0.79375 z m 30.162503,0 v -0.26459 h 0.79375 0.79375 v 0.26459 0.26458 h -0.79375 -0.79375 z m 31.22083,0 v -0.26459 h 0.79375 0.79375 v 0.26459 0.26458 h -0.79375 -0.79375 z m 25.4,0 v -0.26459 h 0.26458 0.26459 v 0.26459 0.26458 h -0.26459 -0.26458 z m 2.11667,0 v -0.26459 h 0.52916 0.52917 v 0.26459 0.26458 h -0.52917 -0.52916 z m 7.40833,0 v -0.26459 h 0.79375 0.79375 v 0.26459 0.26458 h -0.79375 -0.79375 z m 22.75416,0 v -0.26459 h 1.05834 1.05833 v 0.26459 0.26458 h -1.05833 -1.05834 z m 41.80417,0 v -0.26459 h 0.26459 0.26458 v 0.26459 0.26458 h -0.26458 -0.26459 z m 8.99584,0 v -0.26459 h 0.52916 0.52917 v 0.26459 0.26458 h -0.52917 -0.52916 z m 42.33333,0 v -0.26459 h 0.52917 0.52916 v 0.26459 0.26458 h -0.52916 -0.52917 z m 17.4625,0 v -0.26459 h 0.26458 0.26459 v 0.26459 0.26458 h -0.26459 -0.26458 z m 16.40417,0 v -0.26459 h 0.26458 0.26458 v 0.26459 0.26458 h -0.26458 -0.26458 z m 39.6875,0 v -0.26459 h 0.52916 0.52917 v 0.26459 0.26458 h -0.52917 -0.52916 z m 21.69583,0 v -0.26459 h 0.26458 0.26459 v 0.26459 0.26458 h -0.26459 -0.26458 z m 10.05417,0 v -0.26459 h 0.79375 0.79375 v 0.26459 0.26458 h -0.79375 -0.79375 z m 30.1625,0 v -0.26459 h 0.79375 0.79375 v 0.26459 0.26458 h -0.79375 -0.79375 z m 31.22083,0 v -0.26459 h 0.79375 0.79375 v 0.26459 0.26458 h -0.79375 -0.79375 z m 25.4,0 v -0.26459 h 0.26458 0.26459 v 0.26459 0.26458 h -0.26459 -0.26458 z m 2.11667,0 v -0.26459 h 0.52916 0.52917 v 0.26459 0.26458 h -0.52917 -0.52916 z m 7.40833,0 v -0.26459 h 0.79375 0.79375 v 0.26459 0.26458 H 493.63075 492.837 Z M -93.479667,198.1921 v -0.26458 h 0.79375 0.79375 v 0.26458 0.26458 h -0.79375 -0.79375 z m 50.8,0 v -0.26458 h 1.05834 1.05833 v 0.26458 0.26458 h -1.05833 -1.05834 z m 39.6874973,0 v -0.26458 h 0.79375 0.79375 v 0.26458 0.26458 h -0.79375 -0.79375 z m 67.2041697,0 v -0.26458 h 1.058334 1.058333 v 0.26458 0.26458 H 65.270334 64.212 Z m 117.475,0 v -0.26458 h 1.05833 1.05834 v 0.26458 0.26458 h -1.05834 -1.05833 z m 42.33333,0 v -0.26458 h 0.79375 0.79375 v 0.26458 0.26458 h -0.79375 -0.79375 z m 50.8,0 v -0.26458 h 1.05834 1.05833 v 0.26458 0.26458 h -1.05833 -1.05834 z m 39.6875,0 v -0.26458 h 0.79375 0.79375 v 0.26458 0.26458 h -0.79375 -0.79375 z m 67.20417,0 v -0.26458 h 1.05833 1.05834 v 0.26458 0.26458 h -1.05834 -1.05833 z m 117.475,0 v -0.26458 h 1.05833 1.05834 v 0.26458 0.26458 h -1.05834 -1.05833 z m -220.6625,-1.32292 h -4.10104 -4.10104 -6.7314 H 70.503591 -122.58383 v -0.26458 -0.26458 h 192.822838 204.845912 4.23333 7.14375 73.23117 83.47605 10.24486 29.50105 29.50104 v 0.26458 0.26458 h -29.76563 -29.76562 -6.7314 -2.9843 -2.9843 -6.7314 -73.09889 -73.09888 z"
       id="path24" /></g></svg>`,
    obstacleLarge: `
<svg
   width="49.999992"
   height="48"
   viewBox="0 0 49.999992 48"
   version="1.1"
   id="svg1"
   xml:space="preserve"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg"><defs
     id="defs1" /><g
     id="layer1"
     transform="matrix(1.8897638,0,0,1.8897638,-228.08999,-459.8437)"><path
       fill="currentColor"
       d="m 129.16429,268.46938 v -0.26459 h 0.26458 0.26458 v 0.26459 0.26458 h -0.26458 -0.26458 z m 13.75833,0 v -0.26459 h -2.38125 -2.38125 v -0.26458 -0.26458 h 0.52917 0.52916 v -5.55625 -5.55625 h -1.19944 -1.19945 l -0.91722,-0.91723 -0.91722,-0.91722 v -3.73188 -3.73189 l 0.37798,-0.37797 0.37797,-0.37798 h 0.56697 0.56696 l 0.37798,0.37798 0.37797,0.37797 v 3.32619 3.32619 h 0.79375 0.79375 v -4.91369 -4.91369 l 0.37798,-0.37797 0.37797,-0.37798 h 1.09614 1.09613 l 0.37797,0.37798 0.37798,0.37797 v 6.76578 6.76577 h 0.79375 0.79375 v -3.85536 -3.85535 l 0.37798,-0.37798 0.37797,-0.37798 h 0.56697 0.56696 l 0.37798,0.37798 0.37797,0.37798 v 3.46544 3.46545 l -1.18366,1.18366 -1.18366,1.18366 h -0.93301 -0.933 v 4.49792 4.49791 h 0.26458 0.26459 v 0.26459 0.26458 h -0.26459 -0.26458 z m -22.225,-0.52917 v -0.26458 h 0.26458 0.26459 v 0.26458 0.26458 h -0.26459 -0.26458 z m 3.70417,-3.43958 v -3.70417 h -0.67028 -0.67028 l -0.91722,-0.91722 -0.91722,-0.91722 v -3.20272 -3.20272 l 0.37797,-0.37798 0.37798,-0.37797 h 0.30238 0.30238 l 0.37798,0.37797 0.37797,0.37798 v 3.06161 3.0616 h 0.52917 0.52917 v -6.76577 -6.76577 l 0.37797,-0.37798 0.37798,-0.37798 h 0.56696 0.56697 l 0.37797,0.37798 0.37798,0.37798 v 3.59077 3.59077 h 0.79375 0.79375 v -2.26785 -2.26786 l 0.39687,-0.39688 0.39688,-0.39687 0.39687,0.39687 0.39688,0.39688 v 2.41217 2.41218 l -0.64943,0.64943 -0.64943,0.64943 h -0.93807 -0.93807 v 7.14375 7.14375 h -1.32292 -1.32291 z m 6.87916,1.05833 v -2.64583 h -0.40569 -0.4057 l -0.91722,-0.91722 -0.91722,-0.91723 v -2.14438 -2.14439 l 0.39687,-0.39687 0.39688,-0.39688 0.39687,0.39688 0.39688,0.39687 v 2.26786 2.26786 h 0.52917 0.52916 v -3.59078 -3.59077 l 0.39688,-0.39688 0.39687,-0.39687 0.39688,0.39687 0.39687,0.39688 v 3.59077 3.59078 h 0.52917 0.52917 v -2.26786 -2.26786 l 0.39687,-0.39687 0.39688,-0.39688 0.39687,0.39688 0.39688,0.39687 v 2.1476 2.14759 l -0.64944,0.64943 -0.64943,0.64943 h -0.67348 -0.67349 v 2.91042 2.91041 h -0.79375 -0.79375 z m 5.82084,2.38125 v -0.26458 h 0.26458 0.26458 v 0.26458 0.26458 h -0.26458 -0.26458 z m 7.40833,-1.05833 v -0.26459 h 0.26458 0.26459 v 0.26459 0.26458 h -0.26459 -0.26458 z"
       id="path23" /></g></svg>`,
    obstacleSmall: `
<svg
   width="23.000008"
   height="48"
   viewBox="0 0 23.000008 48.000001"
   version="1.1"
   id="svg1"
   xml:space="preserve"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg"><defs
     id="defs1" /><g
     id="layer1"
     transform="matrix(1.8897638,0,0,1.8897638,-121.62886,-459.8437)"><path
       d="m 72.299443,268.46938 v -0.26459 h 0.26458 0.26458 v 0.26459 0.26458 h -0.26458 -0.26458 z M 66.4786,267.41104 v -0.26458 h 0.26459 0.26458 v 0.26458 0.26459 H 66.74319 66.4786 Z m 1.05834,0 v -0.26458 h 0.52916 0.52917 v -3.70417 -3.70416 h -1.19945 -1.19944 l -0.917222,-0.91722 -0.917222,-0.91723 v -3.73188 -3.73189 l 0.377976,-0.37797 0.377976,-0.37798 h 0.566962 0.56697 l 0.37797,0.37798 0.37798,0.37797 v 3.32619 3.32619 h 0.79375 0.79375 v -6.50119 -6.50119 l 0.37798,-0.37797 0.37797,-0.37798 h 1.09613 1.096133 l 0.37798,0.37798 0.37798,0.37797 v 6.50119 6.50119 h 0.79375 0.79375 v -3.85535 -3.85536 l 0.37797,-0.37798 0.37798,-0.37797 h 0.56696 0.56697 l 0.37797,0.37797 0.37798,0.37798 v 3.73003 3.73003 l -1.18366,1.18366 -1.18367,1.18366 h -0.933 -0.933 v 4.23333 4.23334 H 69.91819 67.53694 Z m 6.350003,-0.52916 v -0.26459 h 0.26458 0.26458 v 0.26459 0.26458 h -0.26458 -0.26458 z"
       fill="currentColor"
       id="path1-2" /></g></svg>`,
  };
  private dinoRef: HTMLDivElement | null = null;
  private jump = false;
  private jumping = false;
  private obstaclesRef: Array<HTMLDivElement | null> = [null, null];
  private runFrame = 0;
  private runInterval: number | undefined;

  private shadow: ShadowRoot;

  constructor() {
    super();
    this.shadow = this.attachShadow({ mode: 'open' });
  }

  checkCollision() {
    const dino = this.dinoRef;

    if (!dino) return;

    this.obstaclesRef.forEach((ob) => {
      if (!ob) return;

      const dinoRect = dino.getBoundingClientRect();
      const obRect = ob.getBoundingClientRect();
      const distance = obRect.left - dinoRect.right;

      if (!this.jumping && distance < 80 && distance > -30) {
        this.jumping = true;
        this.jump = true;
        this.updateDino();
        dino.classList.add('jump');
        setTimeout(() => {
          this.jump = false;
          this.jumping = false;
          this.updateDino();
          dino.classList.remove('jump');
        }, 700);
      }
    });

    requestAnimationFrame(() => this.checkCollision());
  }

  connectedCallback() {
    this.render();
    this.dinoRef = this.shadow.querySelector('.dino') as HTMLDivElement;
    this.obstaclesRef = [
      this.shadow.querySelector('.obstacle.small') as HTMLDivElement,
      this.shadow.querySelector('.obstacle.large') as HTMLDivElement,
    ];

    this.runInterval = window.setInterval(() => {
      this.runFrame = this.runFrame === 0 ? 1 : 0;
      this.updateDino();
    }, 200);

    this.checkCollision();

    this.style.width = '100%';
  }

  disconnectedCallback() {
    if (this.runInterval) clearInterval(this.runInterval);
  }

  attributeChangedCallback(name: string, oldValue: string, newValue: string) {
    if (name === 'dino-color') {
      this.dinoRef?.style.setProperty('--dino-color', newValue);
    }
  }

  render() {
    this.shadow.innerHTML = `
      <style>
        .dino-game {
          position: relative;
          width: 100%;
          height: 180px;
          overflow: hidden;
          color: #757575; /* fallback for text.secondary */
        }
        .cloud {
          position: absolute;
          top: 20px;
          left: 100%;
          width: 80px;
          animation: moveCloud 15s linear infinite;
        }
        @keyframes moveCloud {
          from { left: 100%; }
          to { left: -100px; }
        }
        .ground {
          position: absolute;
          bottom: 0;
          width: 2400px;
          height: 100%;
          overflow: hidden;
        }
        .horizon {
          position: absolute;
          bottom: 0;
          left: 0;
          width: 100%;
          animation: moveTerrain 1.475s linear infinite;
        }
        @keyframes moveTerrain {
          from { left: 0%; }
          to { left: -1200px; }
        }
        .dino {
          position: absolute;
          bottom: 10px;
          left: 50px;
          width: 60px;
          height: 60px;
        }
        .dino.jump {
          animation: jumpDino 0.7s ease-out;
        }
        @keyframes jumpDino {
          0% { bottom: 10px; }
          30% { bottom: 70px; }
          50% { bottom: 90px; }
          70% { bottom: 70px; }
          100% { bottom: 10px; }
        }
        .obstacle {
          position: absolute;
          bottom: 10px;
          left: 100%;
          width: 24px;
          height: 48px;
          animation: moveObstacle 3s linear infinite;
        }
        .obstacle.large {
          width: 50px;
          height: 48px;
          animation-delay: 1.5s;
        }
        @keyframes moveObstacle {
          from { left: 100%; }
          to { left: -50px; }
        }
      </style>
      <div class="dino-game">
        <div class="cloud">
          ${UiLoading.SVGS.cloud}
        </div>
        <div class="ground">
          <div class="horizon">
            ${UiLoading.SVGS.horizon}
          </div>
          <div class="dino">
            ${UiLoading.SVGS.dinoRun1}
          </div>
          <div class="obstacle small">
            ${UiLoading.SVGS.obstacleSmall}
          </div>
          <div class="obstacle large">
            ${UiLoading.SVGS.obstacleLarge}
          </div>
        </div>
      </div>
    `;
  }

  updateDino() {
    const dinoImg = this.shadow.querySelector('.dino') as HTMLImageElement;

    if (!dinoImg) return;

    dinoImg.innerHTML = this.jump
      ? UiLoading.SVGS.dinoJump
      : this.runFrame === 0
        ? UiLoading.SVGS.dinoRun1
        : UiLoading.SVGS.dinoRun2;
  }
}

customElements.define('ui-loading', UiLoading);
